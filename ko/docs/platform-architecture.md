# Enjin 구조 

이제 Enjin과 이더리움을 [이해하셨으니](enjin.md) 다음 단계, 즉 Enjin 플랫폼을 구축하는 여러 요소들이 어떻게 서로 상호 작용하는지에 대해 알아보겠습니다.

게임 자체만 보면 상호 작용 모델은 직관적입니다. 우선 유저가 게임에 입력값 (input)을 보내면 게임이 처리하고 그 결과를 유저에게 나타냅니다. 예를 들어 게임에서 유저가 검을 팔고 싶다면 게임은 유저 인벤토리에서 검을 꺼내오고 유저에게 골드를 보상해줍니다. 그럼 유저는 인벤토리에서 검이 사라지는 것을 보게 됩니다. 하지만 이 흐름은 이더리움이 적용될때 어떻게 변할까요?

![Enjin 구조 도표](images/platform-architecture.png)

도표를 보시면 Enjin에서 진정한 소유권이 보장되는 게임 아이템을 활용하는 상호 작용은 기본적으로 6 단계로 이뤄집니다. 이 예시에서는 검을 판매하려는 유저를 사용하겠습니다.

1.	유저와 게임 간 상호 작용을 통해 유저는 게임에게 검을 판매하라고 한다.
2.	게임은 Enjin의 Trusted Cloud (신뢰할 수 있는 클라우드)에 웹 요청을 보낸다. 요청은 Enjin에게 유저 인벤토리에서 검을 제거하라고 지시한다.
3.	Trusted Cloud는 유저의 Enjin 지갑 앱으로 검 제거 트랜잭션 요청을 보낸다.
4.	유저는 앱을 통해 트랜잭션을 승인하거나 거부할 수 있다.
5.	유저가 승인할 경우 트랜잭션은 이더리움 네트워크에 전달된다. Enjin 스마트 컨트랙트가 유저의 인벤토리 트랜잭션 로직을 다루며, 이번 예시에서는 유저가 트랜잭션을 승인하고 스마트 컨트랙트는 검 제거 작업을 수행한다.
6.	트랜잭션이 성공적으로 진행되었는지 알기 위해 Trusted Cloud는 이더리움 네트워크를 확인한다. 트랜잭션 결과는 Trusted Cloud에서 다시 게임으로 전송되고 유저에게 결과가 어떻게 표시될지는 선택 가능하다. 이 예시 경우, 유저에게 검이 성공적으로 사라진 걸 보여주고 골드를 보상해준다.

# Trusted Cloud(신뢰할 수 있는 클라우드)는 무엇인가?

가이드에서 계속 언급되는 'Enjin Trusted Cloud'가 무엇인지 설명하겠습니다. Trusted Cloud는 이더리움과의 상호 작용을 원활하게 해주는 Enjin의 중개인 서버 역할을 합니다. 이더리움은 직접적으로 상호 작용하기 쉽지 않은 신기술 프로토콜입니다. Enjin이 제공하는 서버와 그 안에 포함된 API는 개발자가 만든 게임이 Enjin 스마트 컨트랙트나 Enjin 지갑앱과 상호 작용 할때 필요한 로직을 따로 어렵게 구현할 필요 없도록 합니다. 이 API를 통해 유저 아이템 관련된 트랜잭션을 쉽게 진행할 수 있습니다. 

또한 스마트 컨트랙트랑 직접 상호 작용하는 것 보다 Trusted Cloud가 에러나 입력 승인을 더 효율적으로 처리합니다. Enjin 플랫폼 서버는 유저의 게임 계정 (예를 들어 스팀, Xbox Live 혹은 PlayStation) 과 유저의 이더리움 지갑 주소간의 연결/링크를 관리합니다. 현재 저희는 클라우드 기반 솔루션을 쓰고 있고, 저희 플랫폼은 호스팅 되고 있으니 따로 설정하거나 구축할 필요가 없습니다. 저희 도구를 사용하기 위해 필요한 건 개발자 계정과 구독 두 가지 입니다. 향후 완전하게 탈중앙화된 생태계를 위해 개발자들이 자체적으로 호스팅된 플랫폼을 구축할 수 있는 방안을 제공할 예정입니다.

# Trusted Cloud API

[GraphQL 쿼리 언어](https://graphql.org/learn/)를 통해 저희 Trusted Cloud랑 인터랙트 할 수 있습니다. 게임에서 웹서비스로 HTTP 웹 요청을 할 수 있다면 역시 Trusted Cloud에도 요청을 보낼 수 있습니다. 저희 스마트 컨트랙트와 인터랙트 하는 것 보다 GraphQL을 통해 Trusted Cloud와 인터랙트하는게 더 강력한 솔루션이지만 다루기가 좀 더 어렵습니다. 때문에 저희 플랫폼으로 유저 아이템을 쉽고 편리하게 관리할 수 있도록 SDK 몇 개를 구축했습니다.

앞으로 저희 팀은 가장 많이 사용되는 게임 기술들을 위한 솔루션을 개발할 예정입니다. 지금은 우선 [Unity 게임 엔진](https://unity3d.com/)에 주목하겠습니다. Unity는 게임을 개발할 수 있는 무료 개발 엔진이며 굉장히 인기가 많습니다. 저희가 제공하는 Unity SDK는 게임 내에서 직접적으로 플랫폼을 활용하고 기본 작업을 진행할 수 있도록 합니다. 또한, 저희 SDK는 Unity 개발자 인터페이스에서 아이템을 관리할 수 있는 에디터 패널 역시 포함하고 있습니다. 이 내용은 나중에 다루겠습니다.

# 게임 등록하기

이제 저희 플랫폼에 대한 이해도가 있고 어떻게 작동하는지 배우셨으니 실제 작동하는 예시를 가지고 설명하겠습니다. 다음 내용은 [개발 위해 게임 등록하기](registering-game.md) 입니다.